"use strict";(self.webpackChunkimdeepmind=self.webpackChunkimdeepmind||[]).push([[862],{13058:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"containers/kubernetes/deployments","title":"Deployments","description":"A Deployment is a higher-level Kubernetes resource that provides declarative updates for Pods and ReplicaSets. It allows us to describe the desired state for our application and lets Kubernetes handle creating and managing Pods, scaling them, and rolling out or rolling back updates automatically.","source":"@site/docs/containers/kubernetes/deployments.md","sourceDirName":"containers/kubernetes","slug":"/containers/kubernetes/deployments","permalink":"/docs/containers/kubernetes/deployments","draft":false,"unlisted":false,"editUrl":"https://github.com/imdeepmind/imdeepmind.github.io/blob/main/docs/containers/kubernetes/deployments.md","tags":[],"version":"current","lastUpdatedBy":"Abhishek Chatterjee","lastUpdatedAt":1757783445000,"sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"ReplicationController and ReplicaSet","permalink":"/docs/containers/kubernetes/replication-sets"},"next":{"title":"Networking","permalink":"/docs/containers/kubernetes/networking"}}');var a=l(74848),s=l(28453);const i={sidebar_position:6},o="Deployments",r={},d=[{value:"Features of Deployments",id:"features-of-deployments",level:2},{value:"Deployment YAML Example",id:"deployment-yaml-example",level:2},{value:"Deployment Lifecycle",id:"deployment-lifecycle",level:2},{value:"Updates in Deployments",id:"updates-in-deployments",level:2},{value:"Rollouts",id:"rollouts",level:2},{value:"Rollbacks",id:"rollbacks",level:2},{value:"Example Deployment with Update Strategy",id:"example-deployment-with-update-strategy",level:2},{value:"Update and Rollback Flow",id:"update-and-rollback-flow",level:2},{value:"Common kubectl Commands for Deployments",id:"common-kubectl-commands-for-deployments",level:2},{value:"Create and Manage",id:"create-and-manage",level:3},{value:"View",id:"view",level:3},{value:"Scaling",id:"scaling",level:3},{value:"Update",id:"update",level:3},{value:"Rollout and Rollback",id:"rollout-and-rollback",level:3},{value:"Delete",id:"delete",level:3},{value:"Use Cases of Deployments",id:"use-cases-of-deployments",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"deployments",children:"Deployments"})}),"\n",(0,a.jsx)(n.p,{children:"A Deployment is a higher-level Kubernetes resource that provides declarative updates for Pods and ReplicaSets. It allows us to describe the desired state for our application and lets Kubernetes handle creating and managing Pods, scaling them, and rolling out or rolling back updates automatically."}),"\n",(0,a.jsx)(n.p,{children:"Deployments abstract away the direct management of ReplicaSets, making it easier to perform tasks like rolling updates, scaling, and self-healing."}),"\n",(0,a.jsx)(n.h2,{id:"features-of-deployments",children:"Features of Deployments"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Ensures a specified number of replicas are running."}),"\n",(0,a.jsxs)(n.li,{children:["Performs ",(0,a.jsx)(n.strong,{children:"rolling updates"})," to update Pods to a new version without downtime."]}),"\n",(0,a.jsxs)(n.li,{children:["Provides easy ",(0,a.jsx)(n.strong,{children:"rollbacks"})," if something goes wrong during deployment."]}),"\n",(0,a.jsxs)(n.li,{children:["Abstracts ",(0,a.jsx)(n.strong,{children:"ReplicaSets"}),", automatically creating and managing them."]}),"\n",(0,a.jsx)(n.li,{children:"Enables scaling up or down easily."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"deployment-yaml-example",children:"Deployment YAML Example"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\n  labels:\n    app: nginx\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n        - name: nginx\n          image: nginx:1.21\n          ports:\n            - containerPort: 80\n"})}),"\n",(0,a.jsx)(n.p,{children:"Explanation:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"replicas"}),": Specifies how many Pods should run."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"selector"}),": Ensures the Deployment manages Pods with ",(0,a.jsx)(n.code,{children:"app: nginx"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"template"}),": Defines the Pod spec (metadata and containers)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"image"}),": Versioned (",(0,a.jsx)(n.code,{children:"nginx:1.21"}),") so updates can be managed via rolling updates."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"deployment-lifecycle",children:"Deployment Lifecycle"}),"\n",(0,a.jsx)("div",{style:{textAlign:"center"},children:(0,a.jsx)(n.mermaid,{value:"flowchart TD\n    A[Deployment] --\x3e B[ReplicaSet]\n    B --\x3e C[Pods]\n    B --\x3e D[Scaling Up/Down]\n    B --\x3e E[Rolling Update / Rollback]"})}),"\n",(0,a.jsx)(n.h2,{id:"updates-in-deployments",children:"Updates in Deployments"}),"\n",(0,a.jsxs)(n.p,{children:["Updates allow us to change aspects of the Deployment specification, most commonly the container image version. Kubernetes uses ",(0,a.jsx)(n.strong,{children:"rolling updates"})," by default to ensure there is no downtime."]}),"\n",(0,a.jsx)(n.p,{children:"During a rolling update:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"A new ReplicaSet is created with the updated specification."}),"\n",(0,a.jsx)(n.li,{children:"Pods from the new ReplicaSet are gradually started."}),"\n",(0,a.jsx)(n.li,{children:"Pods from the old ReplicaSet are terminated one by one."}),"\n",(0,a.jsx)(n.li,{children:"The Deployment ensures that the number of available Pods never goes below a certain threshold."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"The rolling update strategy can be tuned using two parameters:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"maxUnavailable"}),": Maximum number of Pods that can be unavailable during the update."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"maxSurge"}),": Maximum number of extra Pods that can be created above the desired count during the update."]}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Example of an update using ",(0,a.jsx)(n.code,{children:"kubectl"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl set image deployment/nginx-deployment nginx=nginx:1.22\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This changes the image from ",(0,a.jsx)(n.code,{children:"nginx:1.21"})," to ",(0,a.jsx)(n.code,{children:"nginx:1.22"}),". Kubernetes then performs a rolling update."]}),"\n",(0,a.jsx)(n.h2,{id:"rollouts",children:"Rollouts"}),"\n",(0,a.jsx)(n.p,{children:"Kubernetes maintains a history of revisions for each Deployment. Each time a Deployment is updated, a new revision is created. The rollout process ensures these changes are applied gradually and safely."}),"\n",(0,a.jsx)(n.p,{children:"Commands for managing rollouts:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl rollout status deployment/nginx-deployment    # Check rollout status\nkubectl rollout history deployment/nginx-deployment   # View revision history\n"})}),"\n",(0,a.jsx)(n.h2,{id:"rollbacks",children:"Rollbacks"}),"\n",(0,a.jsx)(n.p,{children:"If an update fails (for example, the new Pods crash or fail readiness probes), we can rollback to a previous revision. Kubernetes makes this process easy by maintaining the ReplicaSets created during earlier rollouts."}),"\n",(0,a.jsx)(n.p,{children:"Rollback commands:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl rollout undo deployment/nginx-deployment              # Rollback to previous revision\nkubectl rollout undo deployment/nginx-deployment --to-revision=2   # Rollback to specific revision\n"})}),"\n",(0,a.jsx)(n.p,{children:"During rollback:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The Deployment scales down the ReplicaSet of the failed update."}),"\n",(0,a.jsx)(n.li,{children:"The ReplicaSet of the previous stable version is scaled back up."}),"\n",(0,a.jsx)(n.li,{children:"The application returns to a stable version with minimal downtime."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"example-deployment-with-update-strategy",children:"Example Deployment with Update Strategy"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-deployment\nspec:\n  replicas: 3\n  strategy:\n    type: RollingUpdate\n    rollingUpdate:\n      maxUnavailable: 1\n      maxSurge: 1\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n    spec:\n      containers:\n        - name: nginx\n          image: nginx:1.21\n"})}),"\n",(0,a.jsx)(n.p,{children:"In this example:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"maxUnavailable: 1"})," \u2192 At most one Pod can be unavailable at any time."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"maxSurge: 1"})," \u2192 At most one additional Pod can be created temporarily."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"This ensures smooth updates with minimal disruption."}),"\n",(0,a.jsx)(n.h2,{id:"update-and-rollback-flow",children:"Update and Rollback Flow"}),"\n",(0,a.jsx)("div",{style:{textAlign:"center"},children:(0,a.jsx)(n.mermaid,{value:"flowchart TD\n    A[Current Deployment with ReplicaSet V1] --\x3e|Update Image| B[New ReplicaSet V2 Created]\n    B --\x3e C[Rolling Update Begins]\n    C --\x3e|Pods Shift from V1 to V2 Gradually| D[Stable V2 Deployment]\n    C --\x3e|Failure Detected| E[Rollback Triggered]\n    E --\x3e F[Rollback to ReplicaSet V1]\n    F --\x3e G[Stable V1 Deployment Restored]"})}),"\n",(0,a.jsx)(n.h2,{id:"common-kubectl-commands-for-deployments",children:"Common kubectl Commands for Deployments"}),"\n",(0,a.jsx)(n.h3,{id:"create-and-manage",children:"Create and Manage"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f deployment.yaml          # Create or update a Deployment\nkubectl create deployment nginx --image=nginx  # Quick one-liner Deployment\n"})}),"\n",(0,a.jsx)(n.h3,{id:"view",children:"View"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl get deployments                   # List all Deployments\nkubectl describe deployment nginx-deployment   # Get detailed info\nkubectl get pods -l app=nginx             # See Pods managed by Deployment\n"})}),"\n",(0,a.jsx)(n.h3,{id:"scaling",children:"Scaling"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl scale deployment nginx-deployment --replicas=5   # Scale replicas\n"})}),"\n",(0,a.jsx)(n.h3,{id:"update",children:"Update"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl set image deployment/nginx-deployment nginx=nginx:1.22   # Update image\n"})}),"\n",(0,a.jsx)(n.h3,{id:"rollout-and-rollback",children:"Rollout and Rollback"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl rollout status deployment/nginx-deployment   # Check rollout status\nkubectl rollout history deployment/nginx-deployment  # View rollout history\nkubectl rollout undo deployment/nginx-deployment     # Rollback to previous version\nkubectl rollout undo deployment/nginx-deployment --to-revision=2  # Rollback to specific revision\n"})}),"\n",(0,a.jsx)(n.h3,{id:"delete",children:"Delete"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"kubectl delete deployment nginx-deployment\n"})}),"\n",(0,a.jsx)(n.h2,{id:"use-cases-of-deployments",children:"Use Cases of Deployments"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Running stateless applications (e.g., web servers, APIs)."}),"\n",(0,a.jsx)(n.li,{children:"Handling continuous application updates in CI/CD pipelines."}),"\n",(0,a.jsx)(n.li,{children:"Ensuring zero-downtime upgrades through rolling updates."}),"\n",(0,a.jsx)(n.li,{children:"Managing scaling automatically based on workload."}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,n,l)=>{l.d(n,{R:()=>i,x:()=>o});var t=l(96540);const a={},s=t.createContext(a);function i(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);