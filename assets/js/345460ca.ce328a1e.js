"use strict";(self.webpackChunkimdeepmind=self.webpackChunkimdeepmind||[]).push([[1171],{42270:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"programming/programming-languages/python/pytest","title":"Pytest","description":"Pytest is one of the most widely used testing frameworks in Python. It is known for its simplicity, scalability, and rich feature set. Pytest allows developers to write simple unit tests as well as complex functional tests, and it can easily integrate with other tools to provide a powerful testing experience. It also supports various testing styles, including functional, object-oriented, and parameterized testing.","source":"@site/docs/programming/programming-languages/python/pytest.md","sourceDirName":"programming/programming-languages/python","slug":"/programming/programming-languages/python/pytest","permalink":"/docs/programming/programming-languages/python/pytest","draft":false,"unlisted":false,"editUrl":"https://github.com/imdeepmind/imdeepmind.github.io/blob/main/docs/programming/programming-languages/python/pytest.md","tags":[],"version":"current","lastUpdatedBy":"Abhishek Chatterjee","lastUpdatedAt":1749211863000,"sidebarPosition":19,"frontMatter":{"sidebar_position":19},"sidebar":"tutorialSidebar","previous":{"title":"Unit Testing","permalink":"/docs/programming/programming-languages/python/unit-test"},"next":{"title":"Execution Flow","permalink":"/docs/programming/programming-languages/python/execution-flow"}}');var i=t(74848),a=t(28453);const r={sidebar_position:19},l="Pytest",o={},d=[{value:"Key Features of Pytest",id:"key-features-of-pytest",level:2},{value:"Installing Pytest",id:"installing-pytest",level:2},{value:"Writing Tests with Pytest",id:"writing-tests-with-pytest",level:2},{value:"Example of a Simple Test Function",id:"example-of-a-simple-test-function",level:3},{value:"Running Pytest",id:"running-pytest",level:2},{value:"Assertions in Pytest",id:"assertions-in-pytest",level:2},{value:"Example of Assertion Failure",id:"example-of-assertion-failure",level:3},{value:"Fixtures in Pytest",id:"fixtures-in-pytest",level:2},{value:"Defining a Fixture",id:"defining-a-fixture",level:3},{value:"Example with Cleanup",id:"example-with-cleanup",level:3},{value:"Parametrized Tests",id:"parametrized-tests",level:2},{value:"Example of Parametrized Tests",id:"example-of-parametrized-tests",level:3},{value:"Test Discovery",id:"test-discovery",level:2},{value:"Marking Tests with <code>@pytest.mark</code>",id:"marking-tests-with-pytestmark",level:2},{value:"Example of Skipping a Test",id:"example-of-skipping-a-test",level:3},{value:"Example of Expecting a Failure",id:"example-of-expecting-a-failure",level:3},{value:"Running Tests by Mark",id:"running-tests-by-mark",level:3},{value:"Plugins and Extensions",id:"plugins-and-extensions",level:2},{value:"Running Tests in Parallel with <code>pytest-xdist</code>",id:"running-tests-in-parallel-with-pytest-xdist",level:2},{value:"Example",id:"example",level:3},{value:"Test Coverage with <code>pytest-cov</code>",id:"test-coverage-with-pytest-cov",level:2},{value:"Example:",id:"example-1",level:4}];function c(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"pytest",children:"Pytest"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Pytest"})," is one of the most widely used testing frameworks in Python. It is known for its simplicity, scalability, and rich feature set. Pytest allows developers to write simple unit tests as well as complex functional tests, and it can easily integrate with other tools to provide a powerful testing experience. It also supports various testing styles, including functional, object-oriented, and parameterized testing."]}),"\n",(0,i.jsx)(s.h2,{id:"key-features-of-pytest",children:"Key Features of Pytest"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Simple and Concise"}),": Writing tests in Pytest is simple and concise compared to other testing frameworks like ",(0,i.jsx)(s.code,{children:"unittest"}),". It does not require the use of classes for organizing tests, and tests are often written as simple functions."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Powerful Assertions"}),": Pytest enhances Python\u2019s built-in assert statement with more informative error messages. This makes debugging easier and provides better insights into why a test failed."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Test Discovery"}),": Pytest automatically discovers tests by looking for files and functions that match a naming pattern (e.g., files starting with ",(0,i.jsx)(s.code,{children:"test_"})," or ending with ",(0,i.jsx)(s.code,{children:"_test.py"}),")."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Fixtures"}),": Pytest allows for reusable setup and teardown logic using fixtures, which can be shared across tests."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Plugins"}),": Pytest has a rich ecosystem of plugins, including coverage tracking, parallel test execution, and various reporting tools."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Parameterized Testing"}),": Pytest supports parameterized tests using ",(0,i.jsx)(s.code,{children:"@pytest.mark.parametrize"}),", enabling the testing of a function with multiple input values and expected results."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"installing-pytest",children:"Installing Pytest"}),"\n",(0,i.jsxs)(s.p,{children:["To install Pytest, you can use ",(0,i.jsx)(s.code,{children:"pip"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pip install pytest\n"})}),"\n",(0,i.jsx)(s.h2,{id:"writing-tests-with-pytest",children:"Writing Tests with Pytest"}),"\n",(0,i.jsxs)(s.p,{children:["In Pytest, tests are typically written as functions, not methods inside a class (though using classes is also supported). The test function names should start with ",(0,i.jsx)(s.code,{children:"test_"})," for Pytest to automatically recognize them as tests."]}),"\n",(0,i.jsx)(s.h3,{id:"example-of-a-simple-test-function",children:"Example of a Simple Test Function"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# test_example.py\n\ndef add(a, b):\n    return a + b\n\ndef test_add():\n    assert add(2, 3) == 5\n    assert add(-1, 1) == 0\n    assert add(-1, -1) == -2\n"})}),"\n",(0,i.jsxs)(s.p,{children:["In this example, ",(0,i.jsx)(s.code,{children:"test_add()"})," is a function that checks the correctness of the ",(0,i.jsx)(s.code,{children:"add()"})," function using assertions. The tests are executed by Pytest when you run the test file."]}),"\n",(0,i.jsx)(s.h2,{id:"running-pytest",children:"Running Pytest"}),"\n",(0,i.jsxs)(s.p,{children:["Once you have written the tests, you can run them using the ",(0,i.jsx)(s.code,{children:"pytest"})," command:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pytest\n"})}),"\n",(0,i.jsxs)(s.p,{children:["By default, Pytest will search for files that match the pattern ",(0,i.jsx)(s.code,{children:"test_*.py"})," and will execute any function inside those files that starts with ",(0,i.jsx)(s.code,{children:"test_"}),"."]}),"\n",(0,i.jsx)(s.p,{children:"You can also run tests in a specific file:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pytest test_example.py\n"})}),"\n",(0,i.jsxs)(s.p,{children:["If you want to see more detailed output, you can use the ",(0,i.jsx)(s.code,{children:"-v"})," (verbose) flag:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pytest -v\n"})}),"\n",(0,i.jsx)(s.p,{children:"If you only want to run specific tests, you can specify the test name:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pytest test_example.py::test_add\n"})}),"\n",(0,i.jsx)(s.h2,{id:"assertions-in-pytest",children:"Assertions in Pytest"}),"\n",(0,i.jsxs)(s.p,{children:["One of the key features of Pytest is its powerful assertion system. Instead of using ",(0,i.jsx)(s.code,{children:"self.assertEqual()"})," or other assertion methods (as in ",(0,i.jsx)(s.code,{children:"unittest"}),"), Pytest uses Python\u2019s built-in ",(0,i.jsx)(s.code,{children:"assert"})," statement. Pytest automatically rewrites failed assertions to provide detailed error messages, making it easier to diagnose issues."]}),"\n",(0,i.jsx)(s.h3,{id:"example-of-assertion-failure",children:"Example of Assertion Failure"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"def test_add():\n    assert add(2, 3) == 6  # This will fail\n"})}),"\n",(0,i.jsx)(s.p,{children:"Output:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"E       assert 5 == 6\nE        +  where 5 = add(2, 3)\n"})}),"\n",(0,i.jsx)(s.p,{children:"In the case of failure, Pytest will show the expected and actual values, making it easy to understand why the test failed."}),"\n",(0,i.jsx)(s.h2,{id:"fixtures-in-pytest",children:"Fixtures in Pytest"}),"\n",(0,i.jsx)(s.p,{children:"Fixtures are one of the most powerful features of Pytest. They provide a way to set up resources or state before running a test and can also be used to tear down resources after the test is completed. Fixtures can be shared across multiple tests and even across different test files."}),"\n",(0,i.jsx)(s.h3,{id:"defining-a-fixture",children:"Defining a Fixture"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import pytest\n\n@pytest.fixture\ndef setup_data():\n    data = {'name': 'John', 'age': 30}\n    return data\n\ndef test_person_name(setup_data):\n    assert setup_data['name'] == 'John'\n\ndef test_person_age(setup_data):\n    assert setup_data['age'] == 30\n"})}),"\n",(0,i.jsx)(s.p,{children:"In this example:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["The ",(0,i.jsx)(s.code,{children:"setup_data"})," fixture returns a dictionary that contains some sample data."]}),"\n",(0,i.jsxs)(s.li,{children:["Both ",(0,i.jsx)(s.code,{children:"test_person_name()"})," and ",(0,i.jsx)(s.code,{children:"test_person_age()"})," use the fixture by declaring ",(0,i.jsx)(s.code,{children:"setup_data"})," as a parameter."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Fixtures can also handle cleanup tasks by using the ",(0,i.jsx)(s.code,{children:"yield"})," keyword. Any code after the ",(0,i.jsx)(s.code,{children:"yield"})," statement is considered part of the teardown process."]}),"\n",(0,i.jsx)(s.h3,{id:"example-with-cleanup",children:"Example with Cleanup"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"@pytest.fixture\ndef resource_setup_and_teardown():\n    # Setup phase: Acquire a resource (e.g., a database connection)\n    resource = open('myfile.txt', 'w')\n    yield resource  # This is where the test function will receive the resource\n    # Teardown phase: Close the resource\n    resource.close()\n\ndef test_write_to_file(resource_setup_and_teardown):\n    resource_setup_and_teardown.write('Hello, World!')\n    resource_setup_and_teardown.close()\n"})}),"\n",(0,i.jsxs)(s.p,{children:["In this case, the resource (",(0,i.jsx)(s.code,{children:"myfile.txt"}),") is opened in the setup phase and closed in the teardown phase."]}),"\n",(0,i.jsx)(s.h2,{id:"parametrized-tests",children:"Parametrized Tests"}),"\n",(0,i.jsxs)(s.p,{children:["Pytest allows you to run a single test function multiple times with different sets of input data using the ",(0,i.jsx)(s.code,{children:"@pytest.mark.parametrize"})," decorator. This is useful for testing the same function with a variety of inputs and expected results."]}),"\n",(0,i.jsx)(s.h3,{id:"example-of-parametrized-tests",children:"Example of Parametrized Tests"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"import pytest\n\n@pytest.mark.parametrize('a, b, expected', [\n    (1, 2, 3),\n    (2, 3, 5),\n    (-1, 1, 0),\n    (-2, -3, -5),\n])\ndef test_add(a, b, expected):\n    assert add(a, b) == expected\n"})}),"\n",(0,i.jsxs)(s.p,{children:["In this example, the ",(0,i.jsx)(s.code,{children:"test_add"})," function is run four times with different parameter sets. Pytest will automatically generate tests for each tuple of values."]}),"\n",(0,i.jsx)(s.h2,{id:"test-discovery",children:"Test Discovery"}),"\n",(0,i.jsxs)(s.p,{children:["Pytest automatically discovers tests by searching for files with names matching ",(0,i.jsx)(s.code,{children:"test_*.py"})," and looking for functions within those files whose names start with ",(0,i.jsx)(s.code,{children:"test_"}),". It will then execute those functions as tests."]}),"\n",(0,i.jsx)(s.p,{children:"You can specify a directory for test discovery:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pytest tests/\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Where ",(0,i.jsx)(s.code,{children:"tests/"})," is the directory containing your test files."]}),"\n",(0,i.jsxs)(s.h2,{id:"marking-tests-with-pytestmark",children:["Marking Tests with ",(0,i.jsx)(s.code,{children:"@pytest.mark"})]}),"\n",(0,i.jsx)(s.p,{children:"Pytest allows tests to be marked with tags for different purposes, such as skipping tests, marking them as expected failures, or grouping tests."}),"\n",(0,i.jsx)(s.h3,{id:"example-of-skipping-a-test",children:"Example of Skipping a Test"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:'import pytest\n\n@pytest.mark.skip(reason="This test is skipped")\ndef test_to_skip():\n    assert 1 == 2\n'})}),"\n",(0,i.jsx)(s.h3,{id:"example-of-expecting-a-failure",children:"Example of Expecting a Failure"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"@pytest.mark.xfail\ndef test_expected_failure():\n    assert 1 == 2  # This will be marked as a known failure\n"})}),"\n",(0,i.jsx)(s.h3,{id:"running-tests-by-mark",children:"Running Tests by Mark"}),"\n",(0,i.jsxs)(s.p,{children:["You can also run tests based on their marks. For example, to run only tests that are marked as ",(0,i.jsx)(s.code,{children:"xfail"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pytest -m xfail\n"})}),"\n",(0,i.jsx)(s.h2,{id:"plugins-and-extensions",children:"Plugins and Extensions"}),"\n",(0,i.jsx)(s.p,{children:"Pytest has a rich ecosystem of plugins that extend its functionality. Some of the most popular plugins include:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"pytest-cov"}),": For measuring test coverage."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"pytest-django"}),": For testing Django applications."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"pytest-mock"}),": For mocking in tests."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"pytest-xdist"}),": For running tests in parallel to speed up test execution."]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["To install a plugin, simply use ",(0,i.jsx)(s.code,{children:"pip"}),":"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pip install pytest-cov\n"})}),"\n",(0,i.jsx)(s.p,{children:"And then run it:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pytest --cov=my_module\n"})}),"\n",(0,i.jsxs)(s.h2,{id:"running-tests-in-parallel-with-pytest-xdist",children:["Running Tests in Parallel with ",(0,i.jsx)(s.code,{children:"pytest-xdist"})]}),"\n",(0,i.jsxs)(s.p,{children:["To speed up testing, especially for large test suites, Pytest can run tests in parallel using the ",(0,i.jsx)(s.code,{children:"pytest-xdist"})," plugin."]}),"\n",(0,i.jsx)(s.h3,{id:"example",children:"Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pytest -n 4  # Run tests using 4 processes\n"})}),"\n",(0,i.jsx)(s.p,{children:"This splits the test suite into four processes and runs them simultaneously, which can significantly reduce the overall test run time."}),"\n",(0,i.jsxs)(s.h2,{id:"test-coverage-with-pytest-cov",children:["Test Coverage with ",(0,i.jsx)(s.code,{children:"pytest-cov"})]}),"\n",(0,i.jsxs)(s.p,{children:["Test coverage measures how much of your code is tested by your unit tests. The ",(0,i.jsx)(s.code,{children:"pytest-cov"})," plugin integrates with Pytest to provide coverage reports."]}),"\n",(0,i.jsx)(s.h4,{id:"example-1",children:"Example:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"pip install pytest-cov\npytest --cov=my_module\n"})}),"\n",(0,i.jsx)(s.p,{children:"This will display a test coverage report after running the tests."})]})}function p(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,s,t)=>{t.d(s,{R:()=>r,x:()=>l});var n=t(96540);const i={},a=n.createContext(i);function r(e){const s=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(a.Provider,{value:s},e.children)}}}]);