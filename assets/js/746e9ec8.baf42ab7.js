"use strict";(self.webpackChunkimdeepmind=self.webpackChunkimdeepmind||[]).push([[9226],{41690:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"databases/database-engineering/acid","title":"ACID","description":"This note is complete, reviewed, and considered stable.","source":"@site/docs/databases/database-engineering/acid.md","sourceDirName":"databases/database-engineering","slug":"/databases/database-engineering/acid","permalink":"/docs/databases/database-engineering/acid","draft":false,"unlisted":false,"editUrl":"https://github.com/imdeepmind/imdeepmind.github.io/blob/main/docs/databases/database-engineering/acid.md","tags":[],"version":"current","lastUpdatedBy":"Abhishek Chatterjee","lastUpdatedAt":1768665822000,"sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Transactions","permalink":"/docs/databases/database-engineering/transactions"},"next":{"title":"Locks","permalink":"/docs/databases/database-engineering/locks"}}');var t=s(74848),r=s(28453);const l={sidebar_position:4},a="ACID",d={},o=[{value:"Why ACID Exists",id:"why-acid-exists",level:2},{value:"Atomicity",id:"atomicity",level:2},{value:"Example (Bank Transfer)",id:"example-bank-transfer",level:3},{value:"How Atomicity Is Implemented Internally",id:"how-atomicity-is-implemented-internally",level:3},{value:"Common Misconception",id:"common-misconception",level:3},{value:"Consistency",id:"consistency",level:2},{value:"Types of Consistency",id:"types-of-consistency",level:3},{value:"Database-Level Consistency",id:"database-level-consistency",level:4},{value:"Application-Level Consistency",id:"application-level-consistency",level:4},{value:"Important Truth",id:"important-truth",level:3},{value:"Isolation",id:"isolation",level:2},{value:"Isolation Problems",id:"isolation-problems",level:2},{value:"Dirty Read",id:"dirty-read",level:3},{value:"Non-Repeatable Read",id:"non-repeatable-read",level:3},{value:"Phantom Read",id:"phantom-read",level:3},{value:"Isolation Levels (SQL Standard)",id:"isolation-levels-sql-standard",level:2},{value:"How Isolation Is Implemented",id:"how-isolation-is-implemented",level:3},{value:"Lock-Based (Pessimistic)",id:"lock-based-pessimistic",level:4},{value:"MVCC (Optimistic)",id:"mvcc-optimistic",level:4},{value:"Durability",id:"durability",level:2},{value:"How Durability Is Achieved",id:"how-durability-is-achieved",level:3},{value:"Durability Trade-Offs",id:"durability-trade-offs",level:3},{value:"ACID Across Major Databases",id:"acid-across-major-databases",level:2},{value:"PostgreSQL",id:"postgresql",level:3},{value:"MySQL (InnoDB)",id:"mysql-innodb",level:3},{value:"Oracle",id:"oracle",level:3},{value:"SQL Server",id:"sql-server",level:3},{value:"SQLite",id:"sqlite",level:3},{value:"ACID in Distributed Databases",id:"acid-in-distributed-databases",level:2},{value:"Challenges",id:"challenges",level:3},{value:"Implementation Approaches",id:"implementation-approaches",level:3},{value:"Two-Phase Commit (2PC)",id:"two-phase-commit-2pc",level:4},{value:"Eventual Consistency with Sagas",id:"eventual-consistency-with-sagas",level:4},{value:"Consensus-Based Systems (Raft, Paxos)",id:"consensus-based-systems-raft-paxos",level:4},{value:"Trade-Offs",id:"trade-offs",level:3},{value:"BASE",id:"base",level:2},{value:"BASE Philosophy",id:"base-philosophy",level:3},{value:"BASE vs ACID",id:"base-vs-acid",level:3},{value:"How BASE Systems Work",id:"how-base-systems-work",level:3},{value:"Example: Adding an item to a set in a distributed system",id:"example-adding-an-item-to-a-set-in-a-distributed-system",level:4},{value:"Examples of BASE Systems",id:"examples-of-base-systems",level:3},{value:"When to Use ACID vs BASE",id:"when-to-use-acid-vs-base",level:2},{value:"Use ACID When",id:"use-acid-when",level:3},{value:"Use BASE When",id:"use-base-when",level:3},{value:"Hybrid Approaches",id:"hybrid-approaches",level:3}];function c(e){const n={admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"acid",children:"ACID"})}),"\n",(0,t.jsx)(n.admonition,{title:"Status",type:"tip",children:(0,t.jsx)(n.p,{children:"This note is complete, reviewed, and considered stable."})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"ACID"})," is a set of four guarantees that define a ",(0,t.jsx)(n.strong,{children:"transaction"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"A"}),"tomicity"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"C"}),"onsistency"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"I"}),"solation"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"D"}),"urability"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["A ",(0,t.jsx)(n.strong,{children:"transaction"})," is a logical unit of work that moves the database from one valid state to another."]}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.mermaid,{value:"flowchart LR\n    Start[Transaction Start]\n    Ops[Read / Write Operations]\n    Commit[Commit]\n    Abort[Rollback]\n    Start --\x3e Ops\n    Ops --\x3e Commit\n    Ops --\x3e Abort"})}),"\n",(0,t.jsx)(n.h2,{id:"why-acid-exists",children:"Why ACID Exists"}),"\n",(0,t.jsxs)(n.p,{children:["Databases exist to store ",(0,t.jsx)(n.strong,{children:"shared, persistent state"}),". The moment we introduce:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Multiple users"}),"\n",(0,t.jsx)(n.li,{children:"Concurrent reads & writes"}),"\n",(0,t.jsx)(n.li,{children:"Crashes, power failures, network issues"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"We face a core problem:"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"How do we ensure the data is always correct, even when things go wrong?"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Without strict guarantees:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Money can be created or lost"}),"\n",(0,t.jsx)(n.li,{children:"Inventory can go negative"}),"\n",(0,t.jsx)(n.li,{children:"Partial updates can corrupt data"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["ACID is the ",(0,t.jsx)(n.strong,{children:"contract"})," between the database and our application that defines ",(0,t.jsx)(n.em,{children:"correctness"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"atomicity",children:"Atomicity"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Either ",(0,t.jsx)(n.strong,{children:"all operations"})," in a transaction succeed, or ",(0,t.jsx)(n.strong,{children:"none of them do"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["There is ",(0,t.jsx)(n.strong,{children:"no partial state"})," visible."]}),"\n",(0,t.jsx)(n.h3,{id:"example-bank-transfer",children:"Example (Bank Transfer)"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"Transfer $100 from A to B\n1. A.balance -= 100\n2. B.balance += 100\n"})}),"\n",(0,t.jsx)(n.p,{children:"If the system crashes after step 1 but before step 2:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Without Atomicity \u2192 money disappears"}),"\n",(0,t.jsx)(n.li,{children:"With Atomicity \u2192 both steps rollback"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"how-atomicity-is-implemented-internally",children:"How Atomicity Is Implemented Internally"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Write-Ahead Logging (WAL)"})," is the core mechanism."]}),"\n",(0,t.jsx)(n.p,{children:"Rules:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Changes are written to the ",(0,t.jsx)(n.strong,{children:"log first"})]}),"\n",(0,t.jsx)(n.li,{children:"Only then are data pages modified"}),"\n"]}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant App\n    participant DB\n    participant WAL\n\n    App->>DB: Begin Transaction\n    DB->>WAL: Log intended changes\n    DB->>DB: Modify data pages\n    App->>DB: Commit\n    DB->>WAL: Mark transaction committed"})}),"\n",(0,t.jsx)(n.p,{children:"If a crash happens:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Log is replayed"}),"\n",(0,t.jsx)(n.li,{children:"Uncommitted transactions are undone"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"common-misconception",children:"Common Misconception"}),"\n",(0,t.jsx)(n.p,{children:"Atomicity \u2260 single statement"}),"\n",(0,t.jsx)(n.p,{children:"A transaction can include:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Multiple tables"}),"\n",(0,t.jsx)(n.li,{children:"Multiple indexes"}),"\n",(0,t.jsx)(n.li,{children:"Triggers"}),"\n",(0,t.jsx)(n.li,{children:"Foreign key checks"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"consistency",children:"Consistency"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["A transaction must move the database from ",(0,t.jsx)(n.strong,{children:"one valid state"})," to ",(0,t.jsx)(n.strong,{children:"another valid state"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Consistency is about ",(0,t.jsx)(n.strong,{children:"rules"}),", not isolation or crashes."]}),"\n",(0,t.jsx)(n.h3,{id:"types-of-consistency",children:"Types of Consistency"}),"\n",(0,t.jsx)(n.h4,{id:"database-level-consistency",children:"Database-Level Consistency"}),"\n",(0,t.jsx)(n.p,{children:"Enforced by the DB engine:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Primary keys"}),"\n",(0,t.jsx)(n.li,{children:"Foreign keys"}),"\n",(0,t.jsx)(n.li,{children:"NOT NULL"}),"\n",(0,t.jsx)(n.li,{children:"UNIQUE"}),"\n",(0,t.jsx)(n.li,{children:"CHECK constraints"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"balance >= 0\n"})}),"\n",(0,t.jsx)(n.h4,{id:"application-level-consistency",children:"Application-Level Consistency"}),"\n",(0,t.jsx)(n.p,{children:"Business rules:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"User cannot withdraw more than daily limit"}),"\n",(0,t.jsx)(n.li,{children:"Order must have at least one item"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The database ",(0,t.jsx)(n.strong,{children:"cannot enforce these automatically"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"important-truth",children:"Important Truth"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsxs)(n.strong,{children:["The database guarantees consistency ",(0,t.jsx)(n.em,{children:"only if your transaction logic is correct"}),"."]})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"If you write buggy logic, ACID will faithfully preserve the bug."}),"\n",(0,t.jsx)(n.h2,{id:"isolation",children:"Isolation"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Concurrent transactions should not interfere in a way that violates correctness."}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["But ",(0,t.jsx)(n.strong,{children:"full isolation is expensive"}),", so databases provide ",(0,t.jsx)(n.strong,{children:"levels"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"isolation-problems",children:"Isolation Problems"}),"\n",(0,t.jsxs)(n.p,{children:["Isolation problems describe ",(0,t.jsx)(n.strong,{children:"anomalies that occur when multiple transactions run concurrently without sufficient isolation"}),". The diagrams below show ",(0,t.jsx)(n.em,{children:"what happens"}),"; the explanations tell you ",(0,t.jsx)(n.em,{children:"why it is a problem"})," and ",(0,t.jsx)(n.em,{children:"what guarantee is violated"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Think of isolation as answering this question:"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u201cIf two transactions run at the same time, can one see the intermediate, incomplete, or changing results of the other?\u201d"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"dirty-read",children:"Dirty Read"}),"\n",(0,t.jsxs)(n.p,{children:["A transaction reads data written by another transaction that has ",(0,t.jsx)(n.strong,{children:"not yet committed"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why it is dangerous:"}),"\nIf the writing transaction rolls back, the reading transaction has used ",(0,t.jsx)(n.strong,{children:"data that never officially existed"}),"."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Real-world example:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Transaction T1 updates an account balance but hasn\u2019t committed yet."}),"\n",(0,t.jsx)(n.li,{children:"Transaction T2 reads this new balance and makes a business decision."}),"\n",(0,t.jsx)(n.li,{children:"T1 rolls back."}),"\n",(0,t.jsxs)(n.li,{children:["T2 has now acted on ",(0,t.jsx)(n.strong,{children:"phantom data"}),"."]}),"\n"]}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant T1\n    participant T2\n\n    T1->>DB: Write X=100 (not committed)\n    T2->>DB: Read X=100  (dirty read)\n    T1->>DB: Rollback"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key insight:"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Dirty reads violate the illusion that a transaction only sees ",(0,t.jsx)(n.em,{children:"final, committed"})," data."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"non-repeatable-read",children:"Non-Repeatable Read"}),"\n",(0,t.jsxs)(n.p,{children:["A transaction reads the ",(0,t.jsx)(n.strong,{children:"same row twice"})," and gets ",(0,t.jsx)(n.strong,{children:"different values"}),", because another transaction modified and committed that row in between."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why it is dangerous:"}),"\nThe transaction cannot rely on data staying stable during its execution."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Real-world example:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You read your bank balance."}),"\n",(0,t.jsx)(n.li,{children:"Another transaction updates it."}),"\n",(0,t.jsx)(n.li,{children:"You read it again within the same transaction and see a different value."}),"\n"]}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant T1\n    participant T2\n\n    T1->>DB: Read X=50\n    T2->>DB: Update X=70 + Commit\n    T1->>DB: Read X=70  (non-repeatable)"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key insight:"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Non-repeatable reads break the expectation that ",(0,t.jsx)(n.em,{children:"data you read remains unchanged"})," during a transaction."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"phantom-read",children:"Phantom Read"}),"\n",(0,t.jsxs)(n.p,{children:["A transaction re-runs a ",(0,t.jsx)(n.strong,{children:"range query"})," and sees ",(0,t.jsx)(n.strong,{children:"new or missing rows"})," that were inserted or deleted by another committed transaction."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Why it is dangerous:"}),"\nEven if individual rows don\u2019t change, the ",(0,t.jsx)(n.strong,{children:"set of rows matching a condition"})," does."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Real-world example:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"You count how many users are above age 30."}),"\n",(0,t.jsx)(n.li,{children:"Another transaction inserts a new qualifying user."}),"\n",(0,t.jsx)(n.li,{children:"You run the same query again and get a different count."}),"\n"]}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant T1\n    participant T2\n\n    T1->>DB: SELECT COUNT(*) WHERE age > 30\n    T2->>DB: INSERT age=35 + Commit\n    T1->>DB: SELECT COUNT(*) WHERE age > 30  (phantom)"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Key insight:"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsxs)(n.p,{children:["Phantom reads show that isolation is not just about rows, it\u2019s also about ",(0,t.jsx)(n.strong,{children:"ranges and predicates"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"isolation-levels-sql-standard",children:"Isolation Levels (SQL Standard)"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Level"}),(0,t.jsx)(n.th,{children:"Dirty"}),(0,t.jsx)(n.th,{children:"Non-Repeatable"}),(0,t.jsx)(n.th,{children:"Phantom"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Read Uncommitted"}),(0,t.jsx)(n.td,{children:"Allowed"}),(0,t.jsx)(n.td,{children:"Allowed"}),(0,t.jsx)(n.td,{children:"Allowed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Read Committed"}),(0,t.jsx)(n.td,{children:"Prevented"}),(0,t.jsx)(n.td,{children:"Allowed"}),(0,t.jsx)(n.td,{children:"Allowed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Repeatable Read"}),(0,t.jsx)(n.td,{children:"Prevented"}),(0,t.jsx)(n.td,{children:"Prevented"}),(0,t.jsx)(n.td,{children:"Allowed (SQL standard)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Serializable"}),(0,t.jsx)(n.td,{children:"Prevented"}),(0,t.jsx)(n.td,{children:"Prevented"}),(0,t.jsx)(n.td,{children:"Prevented"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"how-isolation-is-implemented",children:"How Isolation Is Implemented"}),"\n",(0,t.jsx)(n.h4,{id:"lock-based-pessimistic",children:"Lock-Based (Pessimistic)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Row locks"}),"\n",(0,t.jsx)(n.li,{children:"Table locks"}),"\n",(0,t.jsx)(n.li,{children:"Gap locks"}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"mvcc-optimistic",children:"MVCC (Optimistic)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Snapshot reads"}),"\n",(0,t.jsx)(n.li,{children:"Versioned rows"}),"\n"]}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.mermaid,{value:"flowchart TD\n    Tx[Transaction]\n    Snapshot[Snapshot at Start]\n    Versions[Multiple Row Versions]\n    Tx --\x3e Snapshot --\x3e Versions"})}),"\n",(0,t.jsx)(n.h2,{id:"durability",children:"Durability"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"After commit, data will survive crashes, power loss, and restarts."}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"how-durability-is-achieved",children:"How Durability Is Achieved"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Write-Ahead Logs flushed to disk"}),"\n",(0,t.jsx)(n.li,{children:"fsync()"}),"\n",(0,t.jsx)(n.li,{children:"Replication (in some systems)"}),"\n"]}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant DB\n    participant Disk\n\n    DB->>Disk: Flush WAL\n    Disk--\x3e>DB: Acknowledged\n    DB->>App: Commit Success"})}),"\n",(0,t.jsx)(n.h3,{id:"durability-trade-offs",children:"Durability Trade-Offs"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Strong Durability"}),(0,t.jsx)(n.th,{children:"Faster Performance"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"fsync per commit"}),(0,t.jsx)(n.td,{children:"Group commit"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Synchronous replication"}),(0,t.jsx)(n.td,{children:"Asynchronous replication"})]})]})]}),"\n",(0,t.jsx)(n.p,{children:"Some databases allow relaxing durability requirements for improved speed."}),"\n",(0,t.jsx)(n.h2,{id:"acid-across-major-databases",children:"ACID Across Major Databases"}),"\n",(0,t.jsx)(n.h3,{id:"postgresql",children:"PostgreSQL"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Full ACID"}),"\n",(0,t.jsx)(n.li,{children:"MVCC-based isolation"}),"\n",(0,t.jsx)(n.li,{children:"Serializable via SSI"}),"\n",(0,t.jsx)(n.li,{children:"Strong durability by default"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"mysql-innodb",children:"MySQL (InnoDB)"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"ACID compliant"}),"\n",(0,t.jsx)(n.li,{children:"Repeatable Read default"}),"\n",(0,t.jsx)(n.li,{children:"Gap locks prevent phantoms"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"oracle",children:"Oracle"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Very strong ACID"}),"\n",(0,t.jsx)(n.li,{children:"Mature MVCC"}),"\n",(0,t.jsx)(n.li,{children:"Excellent consistency guarantees"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"sql-server",children:"SQL Server"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Lock-based + snapshot isolation"}),"\n",(0,t.jsx)(n.li,{children:"Serializable supported"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"sqlite",children:"SQLite"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"ACID compliant"}),"\n",(0,t.jsx)(n.li,{children:"Single-writer model"}),"\n",(0,t.jsx)(n.li,{children:"WAL improves concurrency"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"acid-in-distributed-databases",children:"ACID in Distributed Databases"}),"\n",(0,t.jsx)(n.p,{children:"Maintaining ACID guarantees across multiple nodes is fundamentally more challenging than in a single-node system."}),"\n",(0,t.jsx)(n.h3,{id:"challenges",children:"Challenges"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Network partitions"}),": We cannot reliably communicate between nodes at all times (CAP theorem)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Replication lag"}),": Data changes propagate asynchronously across replicas"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Two-phase commit overhead"}),": Coordinating commits across multiple nodes is expensive and prone to failures"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Consensus complexity"}),": Ensuring all nodes agree on a consistent state requires sophisticated consensus algorithms"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"implementation-approaches",children:"Implementation Approaches"}),"\n",(0,t.jsx)(n.h4,{id:"two-phase-commit-2pc",children:"Two-Phase Commit (2PC)"}),"\n",(0,t.jsx)(n.p,{children:"A coordination protocol where a coordinator asks all participating nodes if they can commit, then either commits or aborts based on their responses."}),"\n",(0,t.jsx)("div",{style:{textAlign:"center"},children:(0,t.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant Coordinator\n    participant Node1\n    participant Node2\n\n    Coordinator->>Node1: Prepare (can you commit?)\n    Coordinator->>Node2: Prepare (can you commit?)\n    Node1--\x3e>Coordinator: Yes/No\n    Node2--\x3e>Coordinator: Yes/No\n    Coordinator->>Node1: Commit or Abort\n    Coordinator->>Node2: Commit or Abort"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Pros"}),": Strong consistency guarantees",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.strong,{children:"Cons"}),": Blocking operations, poor availability during partitions"]}),"\n",(0,t.jsx)(n.h4,{id:"eventual-consistency-with-sagas",children:"Eventual Consistency with Sagas"}),"\n",(0,t.jsx)(n.p,{children:"Break distributed transactions into a series of local transactions coordinated by application logic. Each step can succeed or fail independently, with compensating transactions for rollbacks."}),"\n",(0,t.jsx)(n.h4,{id:"consensus-based-systems-raft-paxos",children:"Consensus-Based Systems (Raft, Paxos)"}),"\n",(0,t.jsx)(n.p,{children:"Systems like CockroachDB use Raft consensus to replicate a consistent log across nodes, providing strong ACID guarantees even with network failures. This approach is more resilient than traditional 2PC."}),"\n",(0,t.jsx)(n.h3,{id:"trade-offs",children:"Trade-Offs"}),"\n",(0,t.jsxs)(n.p,{children:["Distributed ACID is ",(0,t.jsx)(n.strong,{children:"expensive"})," because:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Coordination latency increases with each additional node"}),"\n",(0,t.jsx)(n.li,{children:"Throughput decreases due to synchronous coordination"}),"\n",(0,t.jsx)(n.li,{children:"Availability suffers during network partitions"}),"\n",(0,t.jsx)(n.li,{children:"Complex failure scenarios require careful handling"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Many distributed systems (Cassandra, DynamoDB) explicitly choose BASE over distributed ACID for better scalability and availability."}),"\n",(0,t.jsx)(n.h2,{id:"base",children:"BASE"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"BASE"})," is an acronym that stands for:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"B"}),"asically Available - The system is available most of the time"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"S"}),"oft state - The state of the system may change without explicit input (due to replication lag)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"E"}),"ventually consistent - The system will eventually reach a consistent state"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Used in ",(0,t.jsx)(n.strong,{children:"NoSQL & large-scale distributed systems"})," to prioritize availability and performance over immediate consistency."]}),"\n",(0,t.jsx)(n.h3,{id:"base-philosophy",children:"BASE Philosophy"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Availability and scalability over strict immediate correctness"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Rather than blocking operations to guarantee consistency, BASE systems accept temporary inconsistencies and resolve them asynchronously. This is a practical trade-off for systems operating at internet scale with thousands of nodes and users across the globe."}),"\n",(0,t.jsx)(n.h3,{id:"base-vs-acid",children:"BASE vs ACID"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Aspect"}),(0,t.jsx)(n.th,{children:"ACID"}),(0,t.jsx)(n.th,{children:"BASE"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Consistency model"}),(0,t.jsx)(n.td,{children:"Strong/immediate consistency"}),(0,t.jsx)(n.td,{children:"Eventual consistency"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Transactions"}),(0,t.jsx)(n.td,{children:"Full ACID transactions"}),(0,t.jsx)(n.td,{children:"No / limited / local transactions"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Availability"}),(0,t.jsx)(n.td,{children:"Can be reduced during failures"}),(0,t.jsx)(n.td,{children:"Designed to be always available"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Latency"}),(0,t.jsx)(n.td,{children:"Higher due to coordination"}),(0,t.jsx)(n.td,{children:"Lower, optimized for speed"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Partition tolerance"}),(0,t.jsx)(n.td,{children:"Limited (2PC fails on partitions)"}),(0,t.jsx)(n.td,{children:"High (designed to handle partitions)"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Use case"}),(0,t.jsx)(n.td,{children:"Critical correctness (financial)"}),(0,t.jsx)(n.td,{children:"High-scale distributed systems"})]})]})]}),"\n",(0,t.jsx)(n.h3,{id:"how-base-systems-work",children:"How BASE Systems Work"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Conflict Resolution Strategies:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Last-Write-Wins (LWW)"}),": The most recent write overwrites older writes (simple but can lose data)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Vector Clocks/Version Vectors"}),": Track causality to detect concurrent writes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Application-Level Resolution"}),": Let the application decide how to merge conflicting versions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"CRDTs (Conflict-free Replicated Data Types)"}),": Data structures that guarantee convergence without coordination"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"example-adding-an-item-to-a-set-in-a-distributed-system",children:"Example: Adding an item to a set in a distributed system"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Node A adds item X"}),"\n",(0,t.jsx)(n.li,{children:"Node B adds item Y"}),"\n",(0,t.jsx)(n.li,{children:"Both additions are replicated asynchronously"}),"\n",(0,t.jsx)(n.li,{children:"Eventually, all nodes converge to X, Y"}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"examples-of-base-systems",children:"Examples of BASE Systems"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"DynamoDB"})," - Strongly consistent reads available but eventually consistent by default"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cassandra"})," - Tunable consistency; can configure reads/writes for performance vs. consistency"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Riak"})," - Distributed key-value store with sophisticated conflict resolution"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Couchbase"})," - NoSQL database with eventual consistency"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Redis Cluster"})," - In-memory data structure store with asynchronous replication"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"These systems:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Replicate aggressively across regions"}),"\n",(0,t.jsx)(n.li,{children:"Accept temporary inconsistencies between replicas"}),"\n",(0,t.jsx)(n.li,{children:"Resolve conflicts asynchronously using various strategies"}),"\n",(0,t.jsx)(n.li,{children:"Prioritize low latency and high availability"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"when-to-use-acid-vs-base",children:"When to Use ACID vs BASE"}),"\n",(0,t.jsx)(n.h3,{id:"use-acid-when",children:"Use ACID When"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Financial transactions"}),": Money transfers, payments, accounting"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Critical data correctness"}),": Medical records, legal contracts"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Business invariants must never break"}),": Unique constraints, referential integrity"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Small to medium scale"}),": Single-region or limited geographic distribution"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Lower throughput requirements"}),": Where latency is less critical than correctness"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"use-base-when",children:"Use BASE When"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Massive global scale"}),": Millions of users across multiple continents"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Low latency is critical"}),": User-facing applications require response times < 100ms"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Temporary inconsistency is acceptable"}),": Social media feeds, inventory counts (approximate is fine)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"High availability"}),": System must remain operational during network partitions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Write-heavy workloads"}),": Need to scale writes horizontally"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"hybrid-approaches",children:"Hybrid Approaches"}),"\n",(0,t.jsxs)(n.p,{children:["Many modern systems use a ",(0,t.jsx)(n.strong,{children:"polyglot persistence"})," strategy:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"ACID database"})," for critical data (user accounts, transactions)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"BASE system"})," for high-volume, eventually-consistent data (activity feeds, recommendations)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Cache layer"})," for read-heavy data"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var i=s(96540);const t={},r=i.createContext(t);function l(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);