"use strict";(self.webpackChunkimdeepmind=self.webpackChunkimdeepmind||[]).push([[9020],{65621:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>o,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"databases/sql/subqueries","title":"Subqueries and Nested Queries","description":"A subquery (or inner query) is a SQL query embedded within another query.","source":"@site/docs/databases/sql/subqueries.md","sourceDirName":"databases/sql","slug":"/databases/sql/subqueries","permalink":"/docs/databases/sql/subqueries","draft":false,"unlisted":false,"editUrl":"https://github.com/imdeepmind/imdeepmind.github.io/blob/main/docs/databases/sql/subqueries.md","tags":[],"version":"current","lastUpdatedBy":"Abhishek Chatterjee","lastUpdatedAt":1760202842000,"sidebarPosition":7,"frontMatter":{"sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Join Queries","permalink":"/docs/databases/sql/join"},"next":{"title":"Common Table Expressions (CTEs)","permalink":"/docs/databases/sql/cte"}}');var l=r(74848),i=r(28453);const t={sidebar_position:7},d="Subqueries and Nested Queries",a={},c=[{value:"Types of Subqueries",id:"types-of-subqueries",level:2},{value:"Scalar Subquery",id:"scalar-subquery",level:3},{value:"Column Subquery",id:"column-subquery",level:3},{value:"Row Subquery",id:"row-subquery",level:3},{value:"Correlated Subquery",id:"correlated-subquery",level:3},{value:"Nested Subqueries",id:"nested-subqueries",level:3},{value:"EXISTS and NOT EXISTS",id:"exists-and-not-exists",level:2}];function u(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"subqueries-and-nested-queries",children:"Subqueries and Nested Queries"})}),"\n",(0,l.jsxs)(n.p,{children:["A ",(0,l.jsx)(n.strong,{children:"subquery"})," (or inner query) is a SQL query embedded within another query.\nA ",(0,l.jsx)(n.strong,{children:"nested query"})," is a broader term describing queries that are nested inside other queries, which can include multiple levels of subqueries."]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Purpose:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Break down complex queries into manageable parts."}),"\n",(0,l.jsx)(n.li,{children:"Filter or compute intermediate results for use in the outer query."}),"\n",(0,l.jsx)(n.li,{children:"Retrieve aggregate or conditional results dynamically."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"types-of-subqueries",children:"Types of Subqueries"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Scalar Subquery"})," \u2013 returns a single value."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Column Subquery"})," \u2013 returns a single column with multiple rows."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Row Subquery"})," \u2013 returns multiple columns but a single row."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Correlated Subquery"})," \u2013 references columns from the outer query; evaluated ",(0,l.jsx)(n.strong,{children:"row by row"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Nested Subqueries"})," \u2013 a subquery within another subquery."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"scalar-subquery",children:"Scalar Subquery"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Definition:"})," Returns a single value; can be used in ",(0,l.jsx)(n.code,{children:"SELECT"}),", ",(0,l.jsx)(n.code,{children:"WHERE"}),", or ",(0,l.jsx)(n.code,{children:"HAVING"}),"."]}),"\n",(0,l.jsx)("div",{style:{textAlign:"center"},children:(0,l.jsx)(n.mermaid,{value:'graph TD\nA["Outer Query"] --\x3e B["Scalar Subquery"]'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SELECT name,\n       (SELECT MAX(salary) FROM employees) AS max_salary\nFROM employees;\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Output (example):"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"name"}),(0,l.jsx)(n.th,{children:"max_salary"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Alice"}),(0,l.jsx)(n.td,{children:"120000"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Bob"}),(0,l.jsx)(n.td,{children:"120000"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Charlie"}),(0,l.jsx)(n.td,{children:"120000"})]})]})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Explanation:"}),"\nThe scalar subquery ",(0,l.jsx)(n.code,{children:"(SELECT MAX(salary)...)"})," runs once and returns a single value, which is applied to all outer query rows."]}),"\n",(0,l.jsx)(n.h3,{id:"column-subquery",children:"Column Subquery"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Definition:"})," Returns a single column with multiple rows; often used with ",(0,l.jsx)(n.code,{children:"IN"}),"."]}),"\n",(0,l.jsx)("div",{style:{textAlign:"center"},children:(0,l.jsx)(n.mermaid,{value:'graph TD\nA["Outer Query"] --\x3e B["Subquery Column"]'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SELECT name\nFROM employees\nWHERE department_id IN (\n    SELECT id FROM departments WHERE location = 'NY'\n);\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Output (example):"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.th,{children:"name"})})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Alice"})}),(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Charlie"})})]})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Explanation:"}),"\nSubquery returns all department IDs in NY. Outer query filters employees in those departments."]}),"\n",(0,l.jsx)(n.h3,{id:"row-subquery",children:"Row Subquery"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Definition:"})," Returns multiple columns but ",(0,l.jsx)(n.strong,{children:"only one row"}),". Often used with comparison operators ",(0,l.jsx)(n.code,{children:"(=, <, >)"}),"."]}),"\n",(0,l.jsx)("div",{style:{textAlign:"center"},children:(0,l.jsx)(n.mermaid,{value:'graph TD\nA["Outer Query"] --\x3e B["Row Subquery (1 row, multiple columns)"]'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SELECT name\nFROM employees\nWHERE (department_id, salary) = (\n    SELECT department_id, MAX(salary)\n    FROM employees\n    GROUP BY department_id\n    LIMIT 1\n);\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Output (example):"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.th,{children:"name"})})}),(0,l.jsx)(n.tbody,{children:(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Alice"})})})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Explanation:"}),"\nOuter query selects employees who match the department ID and maximum salary returned by the row subquery."]}),"\n",(0,l.jsx)(n.h3,{id:"correlated-subquery",children:"Correlated Subquery"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Definition:"})," Subquery that ",(0,l.jsx)(n.strong,{children:"depends on a column from the outer query"}),"; evaluated ",(0,l.jsx)(n.strong,{children:"once per row"})," of outer query."]}),"\n",(0,l.jsx)("div",{style:{textAlign:"center"},children:(0,l.jsx)(n.mermaid,{value:'graph TD\nA["Outer Query Row"] --\x3e B["Correlated Subquery"]\nB --\x3e C["Computation based on outer row"]'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SELECT name\nFROM employees e1\nWHERE salary > (\n    SELECT AVG(salary)\n    FROM employees e2\n    WHERE e2.department_id = e1.department_id\n);\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Output (example):"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.th,{children:"name"})})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Bob"})}),(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Alice"})})]})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Explanation:"}),"\nThe subquery calculates average salary ",(0,l.jsx)(n.strong,{children:"per department"})," for each row of the outer query. Only employees above their department average are returned."]}),"\n",(0,l.jsx)(n.h3,{id:"nested-subqueries",children:"Nested Subqueries"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Definition:"})," A subquery inside another subquery. Useful for multi-level filtering or complex computations."]}),"\n",(0,l.jsx)("div",{style:{textAlign:"center"},children:(0,l.jsx)(n.mermaid,{value:'graph TD\nA["Outer Query"] --\x3e B["Inner Subquery"]\nB --\x3e C["Nested Subquery"]'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SELECT name\nFROM employees\nWHERE department_id IN (\n    SELECT id\n    FROM departments\n    WHERE location IN (\n        SELECT location\n        FROM offices\n        WHERE region = 'East'\n    )\n);\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Output (example):"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.th,{children:"name"})})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Alice"})}),(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Bob"})})]})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Explanation:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Innermost query selects all locations in the East region."}),"\n",(0,l.jsx)(n.li,{children:"Middle query selects department IDs in those locations."}),"\n",(0,l.jsx)(n.li,{children:"Outer query selects employees in those departments."}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"exists-and-not-exists",children:"EXISTS and NOT EXISTS"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Definition:"})," Checks for existence of rows in subqueries."]}),"\n",(0,l.jsx)("div",{style:{textAlign:"center"},children:(0,l.jsx)(n.mermaid,{value:'graph TD\nA["Outer Query"] --\x3e B["EXISTS Subquery"]'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sql",children:"SELECT name\nFROM employees e\nWHERE EXISTS (\n    SELECT 1\n    FROM projects p\n    WHERE p.lead_id = e.employee_id\n);\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Output (example):"})}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.th,{children:"name"})})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Alice"})}),(0,l.jsx)(n.tr,{children:(0,l.jsx)(n.td,{children:"Bob"})})]})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Explanation:"}),"\nOnly employees who are project leads exist in the subquery; returned by outer query."]})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var s=r(96540);const l={},i=s.createContext(l);function t(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);