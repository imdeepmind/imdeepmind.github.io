"use strict";(self.webpackChunkimdeepmind=self.webpackChunkimdeepmind||[]).push([[892],{54104:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"frameworks-libraries/backend/fastapi/deployment","title":"Deployment & Production Setup","description":"Deploying FastAPI in production requires performance tuning, security, and scalability. Below is a detailed breakdown of deployment strategies, Dockerization, cloud platforms, HTTPS, and monitoring.","source":"@site/docs/frameworks-libraries/backend/fastapi/deployment.md","sourceDirName":"frameworks-libraries/backend/fastapi","slug":"/frameworks-libraries/backend/fastapi/deployment","permalink":"/docs/frameworks-libraries/backend/fastapi/deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/imdeepmind/imdeepmind.github.io/blob/main/docs/frameworks-libraries/backend/fastapi/deployment.md","tags":[],"version":"current","lastUpdatedBy":"Abhishek Chatterjee","lastUpdatedAt":1749212834000,"sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"Testing & Debugging","permalink":"/docs/frameworks-libraries/backend/fastapi/testing"},"next":{"title":"Introduction","permalink":"/docs/frameworks-libraries/frontend/react/introduction"}}');var i=r(74848),l=r(28453);const t={sidebar_position:10},d="Deployment & Production Setup",o={},c=[{value:"Deploying with Uvicorn + Gunicorn (Production)",id:"deploying-with-uvicorn--gunicorn-production",level:2},{value:"Installation",id:"installation",level:3},{value:"Run FastAPI with Gunicorn",id:"run-fastapi-with-gunicorn",level:3},{value:"Recommended Settings",id:"recommended-settings",level:3},{value:"Dockerizing FastAPI Apps (<code>Dockerfile</code>, <code>docker-compose</code>)",id:"dockerizing-fastapi-apps-dockerfile-docker-compose",level:2},{value:"(A) Basic <code>Dockerfile</code>",id:"a-basic-dockerfile",level:3},{value:"(B) Optimized Multi-Stage <code>Dockerfile</code>",id:"b-optimized-multi-stage-dockerfile",level:3},{value:"(C) <code>docker-compose.yml</code> (with PostgreSQL)",id:"c-docker-composeyml-with-postgresql",level:3},{value:"Deploying to Cloud Platforms",id:"deploying-to-cloud-platforms",level:2},{value:"(A) AWS (EC2, ECS, EKS)",id:"a-aws-ec2-ecs-eks",level:3},{value:"(B) GCP (Compute Engine, Cloud Run)",id:"b-gcp-compute-engine-cloud-run",level:3},{value:"(C) Azure (App Service, AKS)",id:"c-azure-app-service-aks",level:3},{value:"Serverless Deployment (AWS Lambda, Cloud Run)",id:"serverless-deployment-aws-lambda-cloud-run",level:2},{value:"(A) AWS Lambda (Mangum Adapter)",id:"a-aws-lambda-mangum-adapter",level:3},{value:"(B) Google Cloud Run",id:"b-google-cloud-run",level:3},{value:"VPS Deployment (DigitalOcean, Linode)",id:"vps-deployment-digitalocean-linode",level:2},{value:"Steps",id:"steps",level:3},{value:"HTTPS &amp; Security Headers",id:"https--security-headers",level:2},{value:"(A) HTTPS with Let\u2019s Encrypt",id:"a-https-with-lets-encrypt",level:3},{value:"(B) Security Headers in FastAPI",id:"b-security-headers-in-fastapi",level:3},{value:"Monitoring &amp; Logging",id:"monitoring--logging",level:2},{value:"(A) Prometheus + Grafana",id:"a-prometheus--grafana",level:3},{value:"(B) ELK Stack (Logging)",id:"b-elk-stack-logging",level:3},{value:"(C) Sentry (Error Tracking)",id:"c-sentry-error-tracking",level:3},{value:"Summary Table",id:"summary-table",level:2},{value:"Best Practices Checklist",id:"best-practices-checklist",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"deployment--production-setup",children:"Deployment & Production Setup"})}),"\n",(0,i.jsxs)(n.p,{children:["Deploying FastAPI in production requires ",(0,i.jsx)(n.strong,{children:"performance tuning, security, and scalability"}),". Below is a ",(0,i.jsx)(n.strong,{children:"detailed breakdown"})," of deployment strategies, Dockerization, cloud platforms, HTTPS, and monitoring."]}),"\n",(0,i.jsx)(n.h2,{id:"deploying-with-uvicorn--gunicorn-production",children:"Deploying with Uvicorn + Gunicorn (Production)"}),"\n",(0,i.jsxs)(n.p,{children:["FastAPI runs on ",(0,i.jsx)(n.strong,{children:"ASGI"})," servers. For production:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Uvicorn"})," (ASGI server for FastAPI)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Gunicorn"})," (process manager for Uvicorn workers)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pip install uvicorn gunicorn\n"})}),"\n",(0,i.jsx)(n.h3,{id:"run-fastapi-with-gunicorn",children:"Run FastAPI with Gunicorn"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gunicorn -w 4 -k uvicorn.workers.UvicornWorker main:app\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Flag"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"-w 4"})}),(0,i.jsx)(n.td,{children:"4 worker processes (adjust per CPU cores)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"-k uvicorn.workers.UvicornWorker"})}),(0,i.jsx)(n.td,{children:"Use Uvicorn workers"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"recommended-settings",children:"Recommended Settings"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gunicorn \\\n  --workers 4 \\\n  --worker-class uvicorn.workers.UvicornWorker \\\n  --bind 0.0.0.0:80 \\\n  --timeout 120 \\\n  --log-level info \\\n  main:app\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Best Practices"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Use ",(0,i.jsx)(n.strong,{children:"2x CPU cores + 1"})," for worker count."]}),"\n",(0,i.jsxs)(n.li,{children:["Set ",(0,i.jsx)(n.code,{children:"--timeout"})," > FastAPI\u2019s expected response time."]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"dockerizing-fastapi-apps-dockerfile-docker-compose",children:["Dockerizing FastAPI Apps (",(0,i.jsx)(n.code,{children:"Dockerfile"}),", ",(0,i.jsx)(n.code,{children:"docker-compose"}),")"]}),"\n",(0,i.jsxs)(n.h3,{id:"a-basic-dockerfile",children:["(A) Basic ",(0,i.jsx)(n.code,{children:"Dockerfile"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dockerfile",children:'FROM python:3.9-slim\n\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nCOPY . .\n\nCMD ["gunicorn", "-k", "uvicorn.workers.UvicornWorker", "main:app", "--bind", "0.0.0.0:80"]\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"b-optimized-multi-stage-dockerfile",children:["(B) Optimized Multi-Stage ",(0,i.jsx)(n.code,{children:"Dockerfile"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-dockerfile",children:'# Build stage\nFROM python:3.9 as builder\n\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install --user -r requirements.txt\n\n# Runtime stage\nFROM python:3.9-slim\n\nWORKDIR /app\nCOPY --from=builder /root/.local /root/.local\nCOPY . .\n\nENV PATH=/root/.local/bin:$PATH\nCMD ["gunicorn", "-k", "uvicorn.workers.UvicornWorker", "main:app"]\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"c-docker-composeyml-with-postgresql",children:["(C) ",(0,i.jsx)(n.code,{children:"docker-compose.yml"})," (with PostgreSQL)"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'version: "3.8"\n\nservices:\n  app:\n    build: .\n    ports:\n      - "80:80"\n    depends_on:\n      - db\n    environment:\n      - DATABASE_URL=postgresql://user:pass@db:5432/mydb\n\n  db:\n    image: postgres:13\n    environment:\n      - POSTGRES_USER=user\n      - POSTGRES_PASSWORD=pass\n      - POSTGRES_DB=mydb\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\nvolumes:\n  postgres_data:\n'})}),"\n",(0,i.jsx)(n.h2,{id:"deploying-to-cloud-platforms",children:"Deploying to Cloud Platforms"}),"\n",(0,i.jsx)(n.h3,{id:"a-aws-ec2-ecs-eks",children:"(A) AWS (EC2, ECS, EKS)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"EC2"}),": Manual deployment (Gunicorn + Nginx)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ECS"}),": Dockerized deployment (Fargate)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"EKS"}),": Kubernetes for scaling"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"b-gcp-compute-engine-cloud-run",children:"(B) GCP (Compute Engine, Cloud Run)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Compute Engine"}),": Similar to AWS EC2"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cloud Run"}),": Serverless containers (auto-scaling)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"c-azure-app-service-aks",children:"(C) Azure (App Service, AKS)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"App Service"}),": Managed containers"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"AKS"}),": Kubernetes on Azure"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"serverless-deployment-aws-lambda-cloud-run",children:"Serverless Deployment (AWS Lambda, Cloud Run)"}),"\n",(0,i.jsx)(n.h3,{id:"a-aws-lambda-mangum-adapter",children:"(A) AWS Lambda (Mangum Adapter)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from mangum import Mangum\nfrom fastapi import FastAPI\n\napp = FastAPI()\nhandler = Mangum(app)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Deploy with"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"AWS SAM"}),"\n",(0,i.jsx)(n.li,{children:"Serverless Framework"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"b-google-cloud-run",children:"(B) Google Cloud Run"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"gcloud builds submit --tag gcr.io/my-project/fastapi-app\ngcloud run deploy --image gcr.io/my-project/fastapi-app --platform managed\n"})}),"\n",(0,i.jsx)(n.h2,{id:"vps-deployment-digitalocean-linode",children:"VPS Deployment (DigitalOcean, Linode)"}),"\n",(0,i.jsx)(n.h3,{id:"steps",children:"Steps"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Create a ",(0,i.jsx)(n.strong,{children:"Droplet"})," (Ubuntu 20.04)"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Install:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt update && sudo apt install -y docker-compose nginx\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Deploy with ",(0,i.jsx)(n.code,{children:"docker-compose up -d"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Configure Nginx as reverse proxy:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80;\n    server_name yourdomain.com;\n\n    location / {\n        proxy_pass http://localhost:8000;\n    }\n}\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"https--security-headers",children:"HTTPS & Security Headers"}),"\n",(0,i.jsx)(n.h3,{id:"a-https-with-lets-encrypt",children:"(A) HTTPS with Let\u2019s Encrypt"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt install certbot python3-certbot-nginx\nsudo certbot --nginx -d yourdomain.com\n"})}),"\n",(0,i.jsx)(n.h3,{id:"b-security-headers-in-fastapi",children:"(B) Security Headers in FastAPI"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from fastapi.middleware.httpsredirect import HTTPSRedirectMiddleware\nfrom fastapi.middleware.trustedhost import TrustedHostMiddleware\n\napp.add_middleware(HTTPSRedirectMiddleware)\napp.add_middleware(TrustedHostMiddleware, allowed_hosts=["yourdomain.com"])\n'})}),"\n",(0,i.jsx)(n.h2,{id:"monitoring--logging",children:"Monitoring & Logging"}),"\n",(0,i.jsx)(n.h3,{id:"a-prometheus--grafana",children:"(A) Prometheus + Grafana"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from prometheus_fastapi_instrumentator import Instrumentator\n\nInstrumentator().instrument(app).expose(app)\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Grafana Dashboard"}),": Visualize metrics"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"b-elk-stack-logging",children:"(B) ELK Stack (Logging)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Elasticsearch"}),": Log storage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Logstash"}),": Log processing"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Kibana"}),": Log visualization"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"c-sentry-error-tracking",children:"(C) Sentry (Error Tracking)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import sentry_sdk\n\nsentry_sdk.init(dsn="your-dsn")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"summary-table",children:"Summary Table"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Deployment Method"}),(0,i.jsx)(n.th,{children:"Best For"}),(0,i.jsx)(n.th,{children:"Scalability"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Gunicorn + Uvicorn"})}),(0,i.jsx)(n.td,{children:"Dedicated servers"}),(0,i.jsx)(n.td,{children:"Vertical"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Docker"})}),(0,i.jsx)(n.td,{children:"Consistent environments"}),(0,i.jsx)(n.td,{children:"Horizontal"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"AWS Lambda"})}),(0,i.jsx)(n.td,{children:"Event-driven apps"}),(0,i.jsx)(n.td,{children:"Auto-scaling"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Cloud Run"})}),(0,i.jsx)(n.td,{children:"Serverless containers"}),(0,i.jsx)(n.td,{children:"Auto-scaling"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Kubernetes"})}),(0,i.jsx)(n.td,{children:"Large-scale microservices"}),(0,i.jsx)(n.td,{children:"High"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices-checklist",children:"Best Practices Checklist"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Always use HTTPS"})," (Let\u2019s Encrypt)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Set security headers"})," (CSP, HSTS)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monitor metrics"})," (Prometheus)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Centralize logs"})," (ELK)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Automate deployments"})," (CI/CD)"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var s=r(96540);const i={},l=s.createContext(i);function t(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);